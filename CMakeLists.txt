cmake_minimum_required (VERSION 2.6)
project ("CasparCG Server")

set(DEPENDENCIES_FOLDER "${PROJECT_SOURCE_DIR}/dependencies64")

set(BOOST_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/boost")
set(RXCPP_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/RxCpp/include")
set(TBB_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/tbb/include")
set(GLEW_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/glew/include")
set(SFML_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/sfml/include")
set(FREETYPE_INCLUDE_PATH	"${DEPENDENCIES_FOLDER}/freetype/include")
set(FFMPEG_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/ffmpeg/include")
set(ASMLIB_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/asmlib")
set(FREEIMAGE_INCLUDE_PATH	"${DEPENDENCIES_FOLDER}/freeimage/include")
set(OPENAL_INCLUDE_PATH		"${DEPENDENCIES_FOLDER}/openal/include")
set(BLUEFISH_INCLUDE_PATH	"${DEPENDENCIES_FOLDER}/bluefish/include")

link_directories("${DEPENDENCIES_FOLDER}/boost/stage/lib")
link_directories("${DEPENDENCIES_FOLDER}/tbb/lib")
link_directories("${DEPENDENCIES_FOLDER}/glew/lib")
link_directories("${DEPENDENCIES_FOLDER}/sfml/lib")
link_directories("${DEPENDENCIES_FOLDER}/sfml/extlibs/lib")
link_directories("${DEPENDENCIES_FOLDER}/freetype/objs/win32/vc2010")
link_directories("${DEPENDENCIES_FOLDER}/ffmpeg/lib")
link_directories("${DEPENDENCIES_FOLDER}/asmlib")
link_directories("${DEPENDENCIES_FOLDER}/freeimage/lib")
link_directories("${DEPENDENCIES_FOLDER}/openal/lib")
link_directories("${DEPENDENCIES_FOLDER}/bluefish/lib")
link_directories("${DEPENDENCIES_FOLDER}/zlib/lib")

set_property(GLOBAL PROPERTY USE_FOLDERS ON)

add_definitions( -DSFML_STATIC )
add_definitions( -DBOOST_THREAD_VERSION=4 )
add_definitions( -DTBB_USE_CAPTURED_EXCEPTION=0 )
add_definitions( -DUNICODE )
add_definitions( -D_UNICODE )

if (${MSVC})
	set(CMAKE_CXX_FLAGS			"${CMAKE_CXX_FLAGS}			/EHa /Zi /W4 /WX /MP /fp:fast /FIcommon/compiler/vs/disable_silly_warnings.h")
	set(CMAKE_CXX_FLAGS_DEBUG	"${CMAKE_CXX_FLAGS_DEBUG}	/D TBB_USE_ASSERT=1 /D TBB_USE_DEBUG")
	set(CMAKE_CXX_FLAGS_RELEASE	"${CMAKE_CXX_FLAGS_RELEASE}	/Oi /Ot /Gy")
endif ()

cmake_policy(SET CMP0045 OLD)
include(CMake/PrecompiledHeader.cmake)

add_subdirectory(accelerator)
add_subdirectory(common)
add_subdirectory(core)
add_subdirectory(modules)
add_subdirectory(protocol)
add_subdirectory(shell)
